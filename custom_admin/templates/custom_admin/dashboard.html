{% extends "base.html" %}
{% load static %}
{% block content %}

<div class="d-flex" style="min-height: 100vh;">

  <!-- Sidebar -->
  <aside class="bg-dark text-light p-4" style="width: 260px;">
    <h4 class="fw-bold mb-4">‚öíÔ∏è Adminpanel</h4>
    <ul class="nav flex-column">
      <li class="nav-item mb-2"><a href="{% url 'admin_dashboard' %}" class="nav-link text-light"><i class="fas fa-home me-2"></i>√ñversikt</a></li>
      <li class="nav-item mb-2"><a href="{% url 'admin_services' %}" class="nav-link text-light"><i class="fas fa-cogs me-2"></i>Tj√§nster</a></li>
      <li class="nav-item mb-2"><a href="{% url 'admin_projects' %}" class="nav-link text-light"><i class="fas fa-briefcase me-2"></i>Projekt</a></li>
      <li class="nav-item mb-2"><a href="#" class="nav-link text-light"><i class="fas fa-calendar-alt me-2"></i>Kalender</a></li>
      <li class="nav-item mt-4">
        <form action="{% url 'logout' %}" method="post">{% csrf_token %}
          <button type="submit" class="btn btn-outline-light w-100"><i class="fas fa-sign-out-alt me-2"></i>Logga ut</button>
        </form>
      </li>
    </ul>
  </aside>

  <!-- Main content -->
  <main class="flex-grow-1 bg-light p-5">
    <h2 class="text-dark mb-4">Adminpanel</h2>
    <div class="row g-4 text-center">
      <!-- Tj√§nster -->
      <div class="col-md-4">
        <div class="card bg-dark text-light shadow-lg border-0 h-100">
          <div class="card-body">
            <i class="fas fa-cogs fa-3x text-info mb-3"></i>
            <h5 class="card-title">Tj√§nster</h5>
            <p class="display-5 fw-bold">{{ services_count }}</p>
            <a href="{% url 'admin_services' %}" class="btn btn-outline-info w-100">Hantera</a>
          </div>
        </div>
      </div>

      <!-- Projekt -->
      <div class="col-md-4">
        <div class="card bg-dark text-light shadow-lg border-0 h-100">
          <div class="card-body">
            <i class="fas fa-briefcase fa-3x text-primary mb-3"></i>
            <h5 class="card-title">Projekt</h5>
            <p class="display-5 fw-bold">{{ projects_count }}</p>
            <a href="{% url 'admin_projects' %}" class="btn btn-outline-primary w-100">Hantera</a>
          </div>
        </div>
      </div>

      <!-- Meddelanden -->
      <div class="col-md-4">
        <div class="card bg-dark text-light shadow-lg border-0 h-100">
          <div class="card-body">
            <i class="fas fa-envelope fa-3x text-warning mb-3"></i>
            <h5 class="card-title">Meddelanden</h5>
            <p class="display-5 fw-bold">{{ messages_count|default:"0" }}</p>
            <a href="#" class="btn btn-outline-warning w-100 disabled">Visa (ej aktiv)</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Kalendersektion -->
    <section class="mt-5">
      <h4>üìÖ Projektkalender</h4>
      <div id="calendar"></div>
    </section>
  </main>
</div>

<!-- FullCalendar -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const calendarEl = document.getElementById('calendar');
  const calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    events: [
      {% for project in projects %}
      {
        title: "{{ project.title|escapejs }}",
        start: "{{ project.start_date|date:'Y-m-d' }}",
        end: "{{ project.end_date|date:'Y-m-d' }}"
      },
      {% endfor %}
    ]
  });
  calendar.render();
});
</script>

{% endblock %}
